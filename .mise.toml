[tools]
hugo = "latest"
node = "lts"
"npm:markdownlint-cli" = "latest"
"npm:prettier" = "latest"
"npm:cspell" = "latest"

[settings]
experimental = true
lockfile = true

[tasks.build]
description = "Build Site"
sources = ["content/**/*", "config.toml", "go.mod"]
outputs = ['public/**/*']
quiet = true
alias = "b"
run = """
echo "ğŸ³ Generating site"
hugo --gc --minify -d public
"""

[tasks.serve]
description = "Run development server in debug mode"
env = { HUGO_MODULE_REPLACEMENTS = "github.com/butlerx/hugo-recipes -> ../../hugo-recipes" }
run = 'hugo server -D -w'

[tasks.update]
description = "Update themes and modules"
quiet = true
run = """
echo "ğŸ› Updating Theme"
hugo mod get -u ./...
hugo mod tidy
"""

[tasks.clean]
description = "Clean built site"
quiet = true
run = """
echo "ğŸ§¹ Cleaning old build"
rm -rf public resources
"""

[tasks.format]
description = "Format Markdown files"
run = "prettier --write ."

[tasks."format:check"]
description = "Check formatting"
run = "prettier --check ."

[tasks.lint]
description = "Run markdown linter"
quiet = true
run = """
echo "ğŸœ Testing Markdown"
markdownlint "content"
"""

[tasks.spell]
description = "Check spelling"
quiet = true
run = """
echo "ğŸ”¤ Checking Spelling"
cspell "content/**/*.md"
"""

[tasks.check]
description = "Run all checks"
depends = ["format:check", "lint", "spell"]
